// Generated by CoffeeScript 1.9.1
var cozydb, hideEmail;

cozydb = require('cozydb');

hideEmail = function(email) {
  return email.split('@')[0].replace('.', ' ').replace('-', ' ');
};

module.exports.getDisplayName = function(callback) {
  return cozydb.api.getCozyUser(function(err, user) {
    var name, ref, words;
    if (user != null) {
      if (((ref = user.public_name) != null ? ref.length : void 0) > 0) {
        name = user.public_name;
      } else {
        name = hideEmail(user.email);
        words = name.split(' ');
        name = words.map(function(word) {
          return word.charAt(0).toUpperCase() + word.slice(1);
        }).join(' ');
      }
      return callback(null, name);
    } else {
      return callback(null, null);
    }
  });
};
